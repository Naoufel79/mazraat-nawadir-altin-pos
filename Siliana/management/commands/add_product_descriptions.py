from django.core.management.base import BaseCommand
from Siliana.models import Produit


class Command(BaseCommand):
    help = 'Add descriptions to products'

    def handle(self, *args, **kwargs):
        descriptions = {
            'Col de Dame GIGANTA': '''تين كول دو دام جيجانتا هو من أفخر أصناف التين الفرنسية. يتميز بحجمه الكبير ولونه الأخضر الفاتح من الخارج واللب الوردي الداكن من الداخل. هذا الصنف معروف بطعمه الحلو الاستثنائي وقوامه الطري الكريمي. يعتبر من أفضل أنواع التين للاستهلاك الطازج وللمربيات. يحتوي على نسبة عالية من السكريات الطبيعية والألياف الغذائية، مما يجعله خياراً صحياً ولذيذاً. مثالي للتقديم كحلوى طبيعية أو مع الجبن والمكسرات.''',
            
            'YLN': '''تين YLN (Yellow Long Neck) هو صنف مميز يتميز بلونه الأصفر الذهبي الجميل وعنقه الطويل المميز. يعرف بحلاوته المعتدلة وقوامه العصيري. هذا النوع مثالي لمن يفضل التين ذو الطعم الأقل حلاوة مقارنة بالأصناف الأخرى. يحتوي على كمية جيدة من الفيتامينات والمعادن، خاصة البوتاسيوم والمغنيسيوم. ممتاز للاستهلاك الطازج، التجفيف، أو استخدامه في السلطات والأطباق المختلفة. معروف بفترة حفظ جيدة مقارنة بأنواع التين الأخرى.''',
            
'أوهان الصيني': '''تين أوهان تين ووهان هو صنف من التين موطنه مدينة ووهان في الصين. يشتهر هذا النوع بإنتاجيته العالية ومظهره المميز..''',            
            'إسباني أخضر': '''التين الإسباني الأخضر هو صنف أوروبي أصيل يتميز بلونه الأخضر الزاهي وحجمه المتوسط إلى الكبير. يعرف بقشرته الرقيقة ولبه الوردي الفاتح. هذا النوع له نكهة متوازنة بين الحلاوة والحموضة الخفيفة، مما يجعله مميزاً في الطعم. غني بالفيتامينات A و K والمعادن الأساسية. ممتاز للاستهلاك الطازج أو للطهي في الأطباق المالحة والحلوة. يستخدم بكثرة في المطبخ المتوسطي ويتناسب بشكل رائع مع اللحوم والجبن.''',
            
            'اليوجولي': '''تين اليوجولي هو صنف تركي تقليدي يحظى بتقدير كبير لجودته العالية. يتميز بلونه البني الذهبي وشكله المستدير المنتظم. معروف بقوامه الكثيف وحلاوته الشديدة، مما يجعله مثالياً للتجفيف. هذا النوع غني بالطاقة والألياف والمعادن، خاصة الكالسيوم والحديد. يستخدم بشكل واسع في صناعة التين المجفف التقليدي ويحافظ على نكهته لفترات طويلة. ممتاز كوجبة خفيفة صحية أو كمكون في الحلويات والمخبوزات.''',
            
            'الزبيدي': '''تين الزبيدي هو من أشهر أصناف التين في شمال أفريقيا والشرق الأوسط. يتميز بحجمه الكبير ولونه الأصفر المائل للبني. معروف بقوامه الطري وحلاوته الغنية ونكهته العطرية المميزة. يحتوي على نسبة عالية من السكريات الطبيعية والألياف. هذا النوع ممتاز للاستهلاك الطازج وللتجفيف، وهو المفضل في صناعة الحلويات العربية التقليدية. غني بالبوتاسيوم والكالسيوم، ويعتبر من أفضل أنواع التين للهضم.''',
            
            'السلطاني الفرنسي': '''التين السلطاني الفرنسي هو صنف نبيل معروف بجودته الفائقة. يتميز بلونه البنفسجي الغامق المائل للأسود من الخارج ولبه الأحمر الداكن الغني. هذا النوع له نكهة مركزة وحلاوة عميقة مع لمسات من العسل والتوابل. غني بمضادات الأكسدة والفيتامينات والمعادن الأساسية. يعتبر من أفضل أنواع التين للتقديم الفاخر ويستخدم في المطاعم الراقية. ممتاز مع الجبن الفاخر والمكسرات، وكمكون في الصلصات والأطباق الذواقة.''',
            
            'السوودي': '''تين السوودي هو صنف سعودي أصيل يتميز بخصائصه الفريدة. يتميز بحجمه المتوسط ولونه الأخضر المصفر. معروف بنكهته الحلوة المعتدلة وقوامه المتماسك قليلاً. هذا النوع يتحمل الحرارة العالية ويحافظ على جودته في الظروف الصحراوية. غني بالألياف والمعادن الأساسية. ممتاز للاستهلاك الطازج أو للتجفيف، ويستخدم في صناعة الحلويات السعودية التقليدية. يحتفظ بنكهته وقوامه حتى بعد فترات التخزين الطويلة.''',
            
            'الغدان': '''تين الغدان هو صنف مغربي تقليدي معروف بتميزه. يتميز بلونه الأخضر الفاتح وحجمه الكبير. معروف بقوامه الطري وحلاوته الشديدة ونكهته الغنية. هذا النوع غني بالفيتامينات والمعادن والألياف الغذائية. يستخدم بكثرة في المطبخ المغربي التقليدي، خاصة في الطاجين والحلويات. ممتاز للاستهلاك الطازج أو المطبوخ. يتناسب بشكل رائع مع العسل والمكسرات، ويعتبر من أفضل أنواع التين للمناسبات الخاصة.''',
            
            'براون تركي': '''التين البراون التركي (Brown Turkey) هو من أشهر أصناف التين عالمياً. يتميز بلونه البني النحاسي من الخارج ولبه الوردي الفاتح. معروف بنكهته الحلوة المتوازنة وقوامه العصيري. هذا النوع يتميز بإنتاجيته العالية وقدرته على النمو في مختلف المناخات. غني بالفيتامينات A و K والبوتاسيوم. ممتاز للاستهلاك الطازج، التجفيف، أو الطهي. يستخدم بشكل واسع في صناعة المربيات والحلويات، وهو مثالي للخبز والوصفات الذواقة.''',
            
            'جاسم السوري': '''تين جاسم السوري هو صنف شامي أصيل يتميز بجودته الاستثنائية. يتميز بلونه الأخضر الداكن وحجمه الكبير. معروف بقوامه الكريمي الطري وحلاوته الغنية ونكهته العطرية المميزة. هذا النوع غني بالسكريات الطبيعية والألياف والمعادن. يعتبر من أفخر أنواع التين في بلاد الشام ويستخدم في الضيافة التقليدية. ممتاز للاستهلاك الطازج مع القهوة العربية، وللتجفيف والحفظ. يحافظ على نكهته المميزة طوال فترة التخزين.''',
            
            'ديانا': '''تين ديانا هو صنف إيطالي فاخر معروف بأناقته. يتميز بلونه الأرجواني الداكن وشكله الجميل. معروف بنكهته المعقدة التي تجمع بين الحلاوة والنكهات الفاكهية الغنية. هذا النوع له قوام حريري ناعم ولب أحمر داكن غني. غني بمضادات الأكسدة والفيتامينات. يعتبر من تين الذواقة ويستخدم في المطاعم الفاخرة. ممتاز مع الجبن الإيطالي والبروشوتو، وكمكون في السلطات الراقية والحلويات الفاخرة.''',
            
            'كادوتا': '''تين كادوتا (Kadota) هو صنف كاليفورني شهير يتميز بلونه الأخضر الذهبي الجميل. معروف بلبه الكهرماني الفاتح وحلاوته المعتدلة. هذا النوع له نكهة خفيفة ومنعشة وقوام متماسك قليلاً. غني بالألياف والفيتامينات والمعادن الأساسية. يعتبر من أفضل أنواع التين للتعليب والحفظ، كما أنه ممتاز للتجفيف. يستخدم بشكل واسع في الصناعات الغذائية ويحافظ على لونه الجميل بعد المعالجة. مثالي للاستهلاك الطازج أو في السلطات.'''
        }
        
        updated_count = 0
        not_found = []
        
        for product_name, description in descriptions.items():
            try:
                # Try exact match first
                produit = Produit.objects.get(nom=product_name)
                produit.description = description
                produit.save()
                updated_count += 1
                self.stdout.write(
                    self.style.SUCCESS(f'✓ تم تحديث وصف: {product_name}')
                )
            except Produit.DoesNotExist:
                # Try case-insensitive partial match
                matching_products = Produit.objects.filter(nom__icontains=product_name.split()[0])
                if matching_products.exists():
                    produit = matching_products.first()
                    produit.description = description
                    produit.save()
                    updated_count += 1
                    self.stdout.write(
                        self.style.SUCCESS(f'✓ تم تحديث وصف: {produit.nom} (مطابقة تقريبية)')
                    )
                else:
                    not_found.append(product_name)
                    self.stdout.write(
                        self.style.WARNING(f'⚠ لم يتم العثور على: {product_name}')
                    )
        
        self.stdout.write('\n' + '='*50)
        self.stdout.write(self.style.SUCCESS(f'\n✓ تم تحديث {updated_count} منتج بنجاح!'))
        
        if not_found:
            self.stdout.write(self.style.WARNING(f'\n⚠ المنتجات غير الموجودة: {", ".join(not_found)}'))
            self.stdout.write('\nالمنتجات الموجودة في قاعدة البيانات:')
            for p in Produit.objects.all():
                self.stdout.write(f'  - {p.nom}')
