{% extends 'base.html' %}

{% block title %}تقرير المبيعات - نقطة البيع{% endblock %}

{% block content %}
<h2 style="color: #667eea; text-align: center; margin-bottom: 20px;">📊 تقرير المبيعات</h2>

<form method="get" style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
    <div class="form-group" style="text-align: right;">
        <label for="date_debut">من تاريخ</label>
        <input type="date" id="date_debut" name="date_debut" value="{{ date_debut }}">
    </div>
    
    <div class="form-group" style="text-align: right;">
        <label for="date_fin">إلى تاريخ</label>
        <input type="date" id="date_fin" name="date_fin" value="{{ date_fin }}">
    </div>
    
    <button type="submit" class="btn">🔍 عرض التقرير</button>
</form>

{% if ventes %}
<div class="card" style="background: #d4edda; border-left-color: #28a745; margin-bottom: 20px;">
    <h3 style="color: #28a745;">💰 الإجمالي</h3>
    <p style="font-size: 28px; font-weight: bold; color: #155724;">{{ total|floatformat:2 }} د.ت</p>
    <p style="color: #155724;"><strong>عدد المبيعات:</strong> {{ ventes|length }}</p>
</div>

<h3 style="color: #667eea; margin-bottom: 15px;">تفاصيل المبيعات</h3>

{% for vente in ventes %}
<div class="card">
    <h3>{{ vente.produit.nom }}</h3>
    <p><strong>الكمية:</strong> {{ vente.quantite }} قطعة</p>
    <p><strong>سعر الوحدة:</strong> {{ vente.produit.prix_vente }} د.ت</p>
    <p><strong>الإجمالي:</strong> {{ vente.total|floatformat:2 }} د.ت</p>
    <p><strong>التاريخ:</strong> {{ vente.date_vente|date:"Y-m-d" }}</p>
</div>
{% endfor %}

{% else %}
<div class="alert alert-warning">
    {% if date_debut or date_fin %}
    لا توجد مبيعات في الفترة المحددة.
    {% else %}
    لا توجد مبيعات حتى الآن.
    {% endif %}
</div>
{% endif %}
{% endblock %}
